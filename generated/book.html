<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<meta name="author" content="Philip Sturgeon">
<title>Build APIs You Won&#8217;t Hate</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="book">
<div id="header">
<h1>Build APIs You Won&#8217;t Hate</h1>
<div class="details">
<span id="author" class="author">Philip Sturgeon</span><br>
<span id="email" class="email"><a href="mailto:phil@apisyouwonthate.com">phil@apisyouwonthate.com</a></span><br>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_about_the_author">About the Author</a></li>
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_part_one_theory">1. Part One: Theory</a>
<ul class="sectlevel2">
<li><a href="#theory-paradigms">1.1. Understanding Different Paradigms</a></li>
<li><a href="#theory-contracts">1.2. API Contracts</a></li>
</ul>
</li>
<li><a href="#_part_two_planning_design">2. Part Two: Planning &amp; Design</a>
<ul class="sectlevel2">
<li><a href="#_introduction_2">2.1. Introduction</a></li>
<li><a href="#_editors">2.2. Editors</a></li>
</ul>
</li>
<li><a href="#_part_three_testing_monitoring">3. Part Three: Testing &amp; Monitoring</a></li>
<li><a href="#_part_four_management">4. Part Four: Management</a></li>
<li><a href="#_part_five_further_theory">5. Part Five: Further Theory</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_about_the_author">About the Author</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can contact Philip Sturgeon at <a href="mailto:phil@apisyouwonthate.com">phil@apisyouwonthate.com</a>.</p>
</div>
<div class="paragraph">
<p>Some sort of bio in here. Bikes bikes bikes. Turtles.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This book is my second effort at writing down everything I know about APIs. <em>Build APIs You Wont Hate</em> was essentially every complicated design I had to navigate when building an API for a mobile-centric startup that was basically a combination of Foursquare, Groupon, and Instragram. I had to think about naming endpoints, writing documentation for designers, shaping the response body JSON, was curious about which status codes to use, etc.</p>
</div>
<div class="paragraph">
<p>Then after the initial ebook was released in 2014 I went on to work at a carpooling company that had a few APIs, with folks spread out all over the world. That helped me understand the need for HATEOAS (explained later) a whole lot more, as we were inferring state in all sorts of weird ways and getting it wrong a lot. The folks on that team also helped me learn loads about various forms of integration testing, load testing, standards like JSON:API, and a whole lot more.</p>
</div>
<div class="paragraph">
<p>The original book was just my attempt to help readers navigate complex decisions, decide between alternative approaches, outline the potential pitfalls of various strategies, etc., but these days when I read things I wrote back then it feels dated. Even though I don&#8217;t feel like much of it was outright incorrect, I do disagree with many of the conclusions I came to back then. Modern-day Phil writing this in 2019 has a lot more information to go on.</p>
</div>
<div class="paragraph">
<p>Beyond the gaps in my knowledge, so much has changed in API land between 2014 and 2019. For a while a lot of these changes were incremental and I could just update the book a little for the ebook readers, or expand things with a blog post. Now I feel like the time has come to start from scratch and write a new book, because having people read a whole book then 35+ articles just felt a little silly.</p>
</div>
<div class="paragraph">
<p>Back in 2014, a lot of folks (myself included) were acting like REST was the only way to do things, and older systems like SOAP (or anything RPC-based) were bad and silly. These days RPC in the form of gRPC or GraphQL is all the rage, and some people are acting like REST is bad and silly. Comically at that time most of us were building "RESTish" APIs anyway due to lack of understanding in the benefits of HATEOAS, and REST without HATEOAS is basically RPC with pretty URLs. When 99% of the API developers out there discuss REST vs RPC it&#8217;s a fairly moot point, because they&#8217;re talking about essentially the same thing until they learn the strengths and weakness of both paradigms correctly. This book will help unfurl this mess.</p>
</div>
<div class="paragraph">
<p>Another huge change in HTTP-land is HTTP/2 becoming considerably more available, and viable as a choice. Back when I was writing <em>Build APIs You Wont Hate</em>, nothing much supported HTTP/2. This made it feel more like more of an academic concept, which we could look forward to, but not actually use yet. Now most web servers, several languages, and a whole bunch of frameworks support it, either fully or mostly. The only thing holding API developers back from more usage is education and momentum. HTTP/2 changes pretty much everything about API design, so we need to look at it a lot more closely. It fundamentally changes how you design everything, as the sort of things you find yourself trying to solve in HTTP/1.1 at the application level are handled for you so much more seamlessly in HTTP/2.</p>
</div>
<div class="paragraph">
<p>In the past a lot of the API specification tools being used for HTTP-based APIs were&#8230;&#8203; fairly bad. Folks were just using them for documentation (if that), and often using annotation-based approaches, because the tooling out there to help design specifications didn&#8217;t exist. Nobody wants to write a bunch of JSON/YAML by hand, so we just skipped it all, and maybe wrote some docs later, or maybe just didn&#8217;t bother. Now API Specification tooling has grown so much its almost unrecognizable.</p>
</div>
<div class="paragraph">
<p>Previously I&#8217;d recommend people think about their resources, which helps guide which endpoints we need, then jump right into creating serializers to output data, then we start writing the code to populate those serializers. These days I&#8217;d flip that entirely, and start with API specifications first, then use those specifications to build mock servers to get client feedback early, then use those specifications as contracts for contract testing on API responses, and a whole lot more.</p>
</div>
<div class="paragraph">
<p>So, the times have changed, and the approach for this book will feel a bit different to readers of the last. For example, as well as learning about REST properly (which few books have done in a way easy enough for the majority of developers to understand), we&#8217;re going to learn about the other two popular technologies: GraphQL and gRPC. Many chapters will be broken down into sections which explain how certain things work for each of these technologies, so you can understand and compare the differences, or skip sections if you are not interested in using those technologies.</p>
</div>
<div class="paragraph">
<p>Another big difference will be a lack of sample application code. The previous book was basically "How to build RESTish APIs with Laravel" with a lot of theory and occasional code samples for other languages. If you are looking for a "How to build gRPC APIs with Go" or "How to build GraphQL APIs with Erlang" or any other language or technology specific guide, then this book is not going to be for you. We are going to cover REST, gRPC and GraphQL equally, we&#8217;re going to use examples from various languages, and there will not be a "build along with us as you code" or example application bundled with the book, as they get outdated too fast and keeping book code up to date for a decade is not enjoyable or realistic.</p>
</div>
<div class="paragraph">
<p>So, settle in, and lets learn a whole bunch of stuff about building APIs!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_part_one_theory">1. Part One: Theory</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="theory-paradigms">1.1. Understanding Different Paradigms</h3>
<div class="paragraph">
<p>If APIs are the interface for some sort of service, it should not come as a surprise that not all the interfaces in the world are going to have the same needs and requirements. Most of them are a case of "execute a command", "interact with data", or a combination of both.</p>
</div>
<div class="paragraph">
<p>There are three distinct types of Web API which handles these common needs, and these different types are known as paradigms. To oversimplify things a bit, it’s reasonably fair to say that all APIs conform to one of these paradigms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RPC (Remote Procedure Call)</p>
</li>
<li>
<p>REST (Representational State Transfer)</p>
</li>
<li>
<p>Query Languages</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These paradigms are general approaches to building APIs, not a specific tool or specification. They are merely an idea or set of ideas, not a tangible thing. For that, we need to look at implementations.</p>
</div>
<div class="paragraph">
<p><strong>Implementations</strong> are something you can actually download, install, and use to build an API, that conforms to whatever rules the implementors picked, from whichever paradigm (or paradigms) they were interested in at the time.</p>
</div>
<div class="paragraph">
<p><strong>Specifications</strong> (or standards, recommendations, etc.) are often drafted up by various working groups, to help implementations share functionality in the same way. An API and a client in different languages can work together perfectly if they’re all following the specification correctly. The difference between a standard and a specification is usually just down to who made it. When a working group like the IETF or W3C create something, it&#8217;s a standard, but when Google knock something out on their own, it&#8217;s a specification.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SOAP is a W3C recommendation, following the RPC paradigm, with implementations like gSOAP</p>
</li>
<li>
<p>gRPC is an implementation, following the RPC paradigm, which has no standard defined by any working group, but authors Google Inc. did document the protocol in a specification</p>
</li>
<li>
<p>REST is a paradigm, which has never been turned into a specification, and has no official implementations, but building a REST API is usually just a case of picking appropriate standards and tooling</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Making direct comparisons between any of these things is tough because it should be possible to see that paradigms, implementations and specifications are all rather different. We&#8217;ll be covering all the paradigms, and we will be looking at how things work in a few of the more popular implementations throughout the book.</p>
</div>
<div class="paragraph">
<p>First, let us try and figure out the main conceptual differences between the paradigms.</p>
</div>
<div class="sect3">
<h4 id="_remote_procedure_call_rpc">1.1.1. Remote Procedure Call (RPC)</h4>
<div class="paragraph">
<p>RPC is the earliest, simplest form of API interaction. It is about executing a block of code on another server, and when implemented in HyperText Transfer Protocol (HTTP) or Advanced Message Queuing Protocol (AMQP) it can become a Web API. There is a method and some arguments, and that is pretty much it. Think of it like calling a function in JavaScript, taking a method name and arguments.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>POST /sayHello HTTP/1.1
HOST: api.example.com
Content-Type: application/json

{"name": "Racey McRacerson"}</pre>
</div>
</div>
<div class="paragraph">
<p>In JavaScript, the equivalent concept is defining a function, and calling it elsewhere:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">/* Signature */
function sayHello(name) {
  // ...
}

/* Usage */
sayHello("Racey McRacerson");</code></pre>
</div>
</div>
<div class="paragraph">
<p>The idea is the same. An API is built by defining public methods; then, the methods are called with arguments. RPC is just a bunch of functions, but in the context of an HTTP API, that entails putting the method in the URL and the arguments in the query string or body.</p>
</div>
<div class="paragraph">
<p>When used for CRUD ("Create, Read, Update, Delete"), RPC is just a case of sending up and down data fields. This can be fine, but it also means the client is in charge of pretty much everything. The client must know which methods to hit, and at what time, in order to construct its own workflow out of a bevy of methods, with only human interaction or written interactions to help the client application developer figure out what to do and in which order. That might be a positive, or a negative, depending on what sort of relationship you want your clients and servers to have.</p>
</div>
<div class="paragraph">
<p>RPC is without doubt the most prominent paradigm used in API land, possibly because it feels so natural to many programmers. Calling a function locally and calling a function remotely feel so similar, that it just clicks with a lot of developers.</p>
</div>
<div class="paragraph">
<p>That said, there are a few other things to figure out, like should the method name go in the URL, or should it be passed in the body. Should it be entirely POST or a combination of GET and POST? Should we use metadata to describe what the payload data is? To answer questions like this, RPC has a whole bunch of specifications, all of which have concrete implementations:</p>
</div>
<div class="ulist">
<div class="title">Older popular RPC standards</div>
<ul>
<li>
<p>XML-RPC</p>
</li>
<li>
<p>JSON-RPC</p>
</li>
<li>
<p>SOAP (Simple Object Access Protocol)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>XML-RPC and JSON-RPC are not used all that much other than by a minority of entrenched fanatics, but SOAP is still kicking around for a lot of financial services and corporate systems like Salesforce.</p>
</div>
<div class="paragraph">
<p>XML-RPC was problematic, because ensuring data types of XML payloads is tough. In XML, a lot of things are just strings, which JSON does improve, but has trouble differentiating different data formats like integers and decimals.</p>
</div>
<div class="paragraph">
<p>You need to layer metadata on top in order to describe things such as which fields correspond to which data types. This became part of the basis for SOAP, which used XML Schema and a WSDL (Web Services Description Language) to explain what went where and what it contained.</p>
</div>
<div class="paragraph">
<p>This metadata is essentially what most science teachers drill into you from a young age: "label your units!". The sort of thing that stops people paying $100 for something that should have been $1 but was just marked as <code>price: 100</code> which was meant to be cents&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>All three of these specifications had implementations created by various people, mostly as open-source projects. Occasionally the folks who put the standard together created an official implementation in their favourite language, and the community built their own in other languages they wanted to use.</p>
</div>
<div class="paragraph">
<p>A modern RPC specification is gRPC, which can easily be considered modern SOAP. It uses a data format called Protobuf, which requires a schema file as well as the data instance, much like the WSDL in SOAP. This Protobuf file is shared with both the client and the server, and then messages can be verified and passed between the server and client in binary, which leads to smaller messages than passing around big chunks of JSON.</p>
</div>
<div class="paragraph">
<p>gRPC focuses on making single RPC interactions, and it aims to achieve this as quickly as possible, thanks to the aforementioned binary benefits, and its other huge benefit: HTTP/2. All of the gRPC implementations are HTTP/2 by default, and usually handle this with their own built-in web server to make sure HTTP/2 works the whole way through the transaction.</p>
</div>
</div>
<div class="sect3">
<h4 id="_representational_state_transfer_rest">1.1.2. Representational State Transfer (REST)</h4>
<div class="paragraph">
<p>REST is a network paradigm, published by Roy Fielding in a dissertation in 2000. REST is all about a client-server relationship, where server-side data are made available through representations of data in simple formats. This format is usually JSON or XML but could be anything (including Protobuf).</p>
</div>
<div class="paragraph">
<p>These representations portray data from various sources as simple "resources", or "collections" of resources, which are then potentially modifiable with actions and relationships being made discoverable via a concept known as HATEOAS (Hypermedia as the Engine of Application State). That&#8217;s a rough acronym that confuses folks, so many API people just use the term "Hypermedia Controls" to mean the same thing.</p>
</div>
<div class="paragraph">
<p>Hypermedia controls are fundamental to REST. It is merely the concept of providing "next available actions", which could be related data, or more often it&#8217;s actions available for that resource in its current state, like having a "pay" option for an invoice that has not yet been paid.</p>
</div>
<div class="paragraph">
<p>These actions are just links, but the idea is the client knows that an invoice is payable by the presence of a "pay" link, and if that link is not there it should not show that option to the end user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
  "data": {
    "type": "invoice",
    "id": "093b941d",
    "attributes": {
      "created_at": "2017–06–15 12:31:01Z",
      "sent_at": "2017–06–15 12:34:29Z",
      "paid_at": null,
      "status": "published"
    }
  },
  "links": {
    "pay": "https://api.acme.com/invoices/093b941d/payment_attempts"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is quite different to RPC. Imagine the two approaches were humans answering the phones for a doctors office:</p>
</div>
<div class="paragraph">
<p><strong>Client:</strong> Hi, I would like to speak to Dr Watson, is he there?</p>
</div>
<div class="paragraph">
<p><strong>RPC:</strong> No. <strong>click</strong></p>
</div>
<div class="paragraph">
<p><em>Client calls back</em></p>
</div>
<div class="paragraph">
<p><strong>Client:</strong> I found his calendar and luckily I know how to interact with the Google Calander API. I have checked his availability, and it looks like he is off for the day. I would like to visit another doctor, and it looks like Dr Jones is available at 3pm, can I see her then?</p>
</div>
<div class="paragraph">
<p><strong>RPC:</strong> Yes.</p>
</div>
<div class="paragraph">
<p>The burden of knowing what to do is entirely on the client, and this can lead to "fat clients" (i.e: the client contains a lot of business logic). It needs to know all the data, come to the appropriate conclusion itself, then has to figure out what to do next.</p>
</div>
<div class="paragraph">
<p>REST, however, presents you with the next available options:</p>
</div>
<div class="paragraph">
<p><strong>Client:</strong> Hi, I would like to speak to Dr Watson, is he there?</p>
</div>
<div class="paragraph">
<p><strong>REST:</strong> Doctor Watson is not currently in the office, he’ll be back tomorrow, but you have a few options. If it’s not urgent you could leave a message and I’ll get it to him tomorrow, or I can book you with another doctor, would you like to hear who is available today?</p>
</div>
<div class="paragraph">
<p><strong>Client:</strong> Yes, please let me know who is there!</p>
</div>
<div class="paragraph">
<p><strong>REST:</strong> Doctors Smith and Jones, here are links to their profiles.</p>
</div>
<div class="paragraph">
<p><strong>Client:</strong> Ok, Doctor Jones looks like my sort of Doctor, I would like to see them, let’s make that appointment.</p>
</div>
<div class="paragraph">
<p><strong>REST:</strong> Appointment created, here’s a link to the appointment details.</p>
</div>
<div class="paragraph">
<p>REST provided all of the relevant information with the response, and the client was able to pick through the options to resolve the situation.</p>
</div>
<div class="paragraph">
<p>None of this is magic, no client is going to know exactly what to do without being trained, but the client of a REST API can be told to follow the <code>"alternative_doctors": "https://api.example.com/available_doctors?available_at=2017-01-01 03:00:00 GMT"`</code> link. That is far less of a burden on the client than expecting it to check the calendar itself, seek for availability, etc.</p>
</div>
<div class="paragraph">
<p>This centralization of state into the server has benefits for systems with multiple different clients who offer similar workflows. Instead of distributing all the logic, checking data fields, showing lists of "Actions", etc. around various clients — who might come to different conclusions — REST keeps it all in one place.</p>
</div>
<div class="paragraph">
<p>This book will get more in-depth on hypermedia controls later. There are a few other important things to understand about REST APIs first:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>REST must be stateless: not persisting sessions between requests</p>
</li>
<li>
<p>Responses should declare cacheablility: helps your API scale if clients respect the rules</p>
</li>
<li>
<p>REST focuses on uniformity: if you’re using HTTP you should utilize HTTP features whenever possible, instead of inventing conventions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These constraints of REST when applied to HTTP APIs can help the API last for decades, which is a whole lot more complex without these concepts. What does that mean? Well, REST is often described as a series of layers of abstraction on top of RPC, with all relevant instructions related to the handling of that message being baked into the message itself, to avoid having to tell a human about specific ways to handle things. As things change throughout the entire ecosystem, a well trained REST API and client should be able to handle those changes seamlessly, because the REST API is describing itself well and the client is listening. This loosens the coupling found in other paradigms, where a lot of that is baked into the client itself.</p>
</div>
<div class="paragraph">
<p>Some folks look at all this and do not understand why REST requires "all the extra faffing about". There are many who just do not quite get the point of any of it, and consider RPC to be the almighty. To them, it is all about executing the remote code as fast possible, but REST (which can still absolutely be performant) focuses far more on longevity and reduced client-coupling instead. Knowing when to have a fat client and when to have a skinny client is a powerful decision making process to have in your arsenal, so definitely do not be one of those people who things it should always be A, or always be B.</p>
</div>
<div class="paragraph">
<p>Another interesting thing about REST is that it does not require the use of schema metadata (like WSDL or similar), but does allow it. In fact, REST has no opinions either way: it does not explicitly demand it, nor disallow it. The metadata is something many API developers hated about SOAP, and from 2015 to current day, it has become more and more of a growing trend once again, thanks to gRPC and GraphQL including and requiring type systems in their implementations.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/contracts-unspecified-json.jpeg" alt="A cyclist jams a stick into hisi spokes then complains about it. A pretty accurate metaphor for using unspecified JSON in a REST API then blaming REST for it.">
</div>
<div class="title">Figure 1. It&#8217;s pretty common to blame REST for not forcing a type system onto everyone involved in the API, but they&#8217;re absolutely useable. Don&#8217;t blame a paradigm for implementation level decisions.</div>
</div>
<div class="paragraph">
<p>The HTTP community (building REST or whatever) has a few type systems available for optional use, the main one these days being: JSON Schema. JSON Schema is inspired by XML Schema — but not functionally identical — and is one of the most important things to happen to HTTP APIs in years, and will be discussed a lot throughout the book.</p>
</div>
<div class="paragraph">
<p>Unfortunately, REST became a marketing buzzword for most of 2006–2014. It became a metric of quality that developers would aspire to, fail to understand, then label as REST anyway. Most systems saying they are REST are little more than RPC with HTTP verbs and pretty URLs. As such, you might not get cacheability provided, it might have a bunch of wacky conventions, and there might not be any links for you to use to discover next available actions. These APIs are jovially called REST<em>ish</em> by people aware of the difference.</p>
</div>
<div class="paragraph">
<p>REST has no specification which is what leads to some of this confusion, nor does it have concrete implementations. That said, there are two large popular API standards designed to standardize certain aspects of REST APIs that chose to use them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JSON:API</p>
</li>
<li>
<p>OData</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the API advertises itself as using one of these, you will be able to find a whole bunch of tooling that will work out of the box with this API, meaning you can get going quicker. Otherwise you will have to go at it yourself with a common HTTP client, which is fine with a little bit of elbow grease.</p>
</div>
<div class="paragraph">
<p>This book will look more at these two formats and others, as they are hugely important for avoiding bikeshedding over the implementation of trivial features and already solved problems.</p>
</div>
</div>
<div class="sect3">
<h4 id="_query_languages">1.1.3. Query Languages</h4>
<div class="paragraph">
<p>Query languages are designed to give huge flexibility to the client, to make very specific requests, beyond a few simple arguments. Imagine a client asking for an a RPC endpoint to create a very specific report, like asking for a list of companies with unpaid invoices in the last 3 months. You would end up with <code>POST /getCompaniesByUnpaidRecently("&gt;= 3 months")</code> or something very specific.</p>
</div>
<div class="paragraph">
<p>A good query language lets the client treat the API like a data store, and do whatever it wants -within its permissions.</p>
</div>
<div class="paragraph">
<p>There are more query languages out there than there are amateur food bloggers at a NYC restaurant opening, but only some of them specifically aim to solve things for Web APIs.</p>
</div>
<div class="paragraph">
<p>For example, you could probably take some standard SQL, pipe it over an HTTP endpoint <code>POST /sql</code> and call it an API, but you probably don&#8217;t want to do that for a few thousand reasons.</p>
</div>
<div class="sect4">
<h5 id="_sparql_2008">SPARQL (2008)</h5>
<div class="paragraph">
<p>First released in 2008 and finally making it to be a <a href="https://www.w3.org/TR/sparql11-query/">W3C Recommendation</a> in 2013, SPARQL sets out to handle some rather complex queries.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SELECT ?human ?humanLabel
WHERE
{
	?human wdt:P31 wd:Q5 .       #find humans
	?human rdf:type wdno:P40 .   #with at least one P40 (child) statement defined to be "no value"
	SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en" }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Another one popped up in 2008 called FIQL, which is a little easier to parse by human and by computer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>title==foo*;(updated=lt=-P1D,title==*bar)</pre>
</div>
</div>
<div class="paragraph">
<p>Here is an example looking for a title beginning with "foo", and which has either been updated in the last day, or has a title ending with "bar". That&#8217;s a powerful query for such a simple syntax.</p>
</div>
<div class="paragraph">
<p>You could easily imagine shoving this into a query string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/games?filter= + urlencode("title==foo*;(updated=lt=-P1D,title==*bar)")</pre>
</div>
</div>
<div class="paragraph">
<p>This made it to an <a href="https://tools.ietf.org/html/draft-nottingham-atompub-fiql-00">IETF Draft</a>, but never became a final standard.</p>
</div>
<div class="paragraph">
<p>There were other query languages floating around too, but none of those attempts to create query languages ever really made it into the mainstream. Their usage seemed mostly restricted to academic purposes, with folks in universities, libraries, etc., all finding interesting uses, but there are no popular content management systems built around them, and we certainly didn&#8217;t see the major tech players, and hot new startups, or anyone really building out things using these query languages.</p>
</div>
<div class="paragraph">
<p>There was one exception to that, and Facebook actually did have a lesser-known query language based API called FQL (not FIQL). It was their own implementation, they never open-sourced any of it, and despite being a bit weird to work with it was really useful for edge cases that a normal API might not quite be able to answer. You could make a query like "Get me an avatar for all of my friends who live in the UK" or "What is the surname of everyone I know who has a Pet" or any other arbitrary query that popped into your head.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /fql?q=SELECT uid2 FROM friend WHERE uid1=me()&amp;access_token=abc123</pre>
</div>
</div>
<div class="paragraph">
<p>Facebook got a bit fed up with having a RESTish approach to get data, and then having the FQL approach for more targeted queries as well, as they both require different code. As such, they ended up creating a middle-ground between "endpoint-based APIs" (a term they use to group REST/RESTish) and FQL. This middle-ground solution was known as GraphQL, which was released publicly as a specification with a few official implementations in 2015.</p>
</div>
<div class="paragraph">
<p>GraphQL is essentially a RPC-based query language system, where the client is required to ask for specific resources, and also list the specific fields they are interested in receiving back. The GraphQL API will then return only those fields in the response.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/graphql-query-example.png" alt="Example of a GraphQL query being made" width="requesting first the hero (this is a Star Wars example)" height="then the names of the friends for that hero.">
</div>
<div class="title">Figure 2. GraphQL Request (left) and the corresponding response (right).</div>
</div>
<div class="paragraph">
<p>Any sort of RPC action which is intended to cause modifications is done with a "Mutation". SO to handle creates, updates, deletes, etc. you would create a mutation.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/graphql-mutation-example.png" alt="Example of a GraphQL Mutation definition" width="then being called with arguments">
</div>
<div class="title">Figure 3. Definition of a mutation (top left), the mutation request (bottom left), and the response (right).</div>
</div>
<div class="paragraph">
<p>Facebook chose to ignore most of the conventions of the transportation layer so they could focus on building their own conventioins. So although it is often used with HTTP, endpoints are gone, resources are gone, HTTP methods are gone, and most implementations are a single <code>POST /graphql</code> endpoint. This means that resources declaring their own cacheability is gone,and the concept of the uniform interface (as REST defines it) is obliterated.</p>
</div>
<div class="paragraph">
<p>All of this has the advertised benefit of making GraphQL portable enough that it could fit into AMQP, or any other transportation protocol which is something REST could theoretically do but nobody ever bothers with due to the amount of crowbarring it would take.</p>
</div>
<div class="paragraph">
<p>GraphQL has many fantastic features and benefits, which are all bundled in one package, with a nice marketing site. If you are trying to learn how to make calls to a GraphQL API, the <a href="http://graphql.org/learn/">Learn GraphQL</a> documentation will help, and their site has a bunch of other resources.</p>
</div>
<div class="paragraph">
<p>Seeing as GraphQL was built by Facebook, who had previously built a REST<em>ish</em> API, they’re familiar with various REST/HTTP API concepts. Many of those existing concepts were used as inspiration for GraphQL functionality, or carbon copied straight into GraphQL.</p>
</div>
<div class="paragraph">
<p>The main selling point of GraphQL is that it defaults to providing the very smallest response from an API, as you are requesting only the specific bits of data that you want, which minimizes the Content Download portion of the HTTP request.</p>
</div>
<div class="paragraph">
<p>It also reduces the number of HTTP requests necessary to retrieve data for multiple resources, known as the "HTTP N+1 Problem" that has been a problem for API developers through the lifetime of HTTP/1.1. Basically a lot of RPC APIs - and poorly designed REST APIs - would give you a list of resources in the first request, but then to get further information clients would need to make another request for each resource. This means for a list with 10 resources, the client would need to make 11 (1+10) requests to fetch everything it needed. This has been the bane of HTTP/1.1 developers for years, but GraphQL has provided one consistent solution to this via fetching multiple resources in a single request, very similar to how JSON:API and OData have done in the past.</p>
</div>
<div class="paragraph">
<p>GraphQL is a strong and relatively simple solution to the majority of issues that Web API developers ran into in a HTTP/1.1 world, with clients who do not care about Hypermedia Controls. Their optimizations and the way they&#8217;ve built their own conventions inside HTTP mean they&#8217;re kinda stuck unable to leverage HTTP/2 fully, and comically when folks design their APIs with HTTP/2 in mind, most of what GraphQL is aiming to do actually hurts the clients, and makes things slower. A lot of folks see it as REST 2.0, but that is probably down to the marketing hype machine, and not down to education.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s learn some stuff about GraphQL, and see when its useful, and when its not!</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_im_lost">1.1.4. I&#8217;m Lost!</h4>
<div class="paragraph">
<p>Fair comment. This has been a whirlwind tour of a whole bunch of different topics which will be covered more in depth later. If you are nodding and smiling already then you are going to enjoy this book as we delve deeper, and if you have no idea what&#8217;s going on then you are in the right place too.</p>
</div>
<div class="paragraph">
<p>We will cover a lot of specifics about the technical and functional aspects of these various API paradigms and implementations, helping you to figure out when to uses which, and how to build the best possible API whichever of them you chose for a certain use case.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="theory-contracts">1.2. API Contracts</h3>
<div class="paragraph">
<p>The "I" in "API" means interface, and so writing a contract for that interface
is the act of writing down what that interface is going to look like, to avoid
folks having to guess, or go and hunt for some documentation somewhere.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s use the fantastic <a href="https://pokeapi.co/">PokeAPI</a> as an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
  "id": 12,
  "name": "butterfree",
  "base_experience": 178,
  "height": 11,
  "is_default": true,
  "order": 16,
  "weight": 320,
  "abilities": [{
    "is_hidden": true,
    "slot": 3
  }]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we look just at the data, we can deduce that sure, ID is probably an
auto-incrementing identifier, the name seems to be a lower-cased English string,
but after that it starts getting a bit odd.</p>
</div>
<div class="paragraph">
<p>Height and weight, I guess there is no imperial and metric in the game just
units, but what is order all about? The order that pokemon is sat in my current
party? That Ash bumped into in the cartoon? In order of cuteness? What?!</p>
</div>
<div class="paragraph">
<p>An API contract can help answer most of the questions and more for anyone
wanting to understand how an API is meant to work.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Which resources or methods are available and how do you interact with them?</p>
</li>
<li>
<p>Which HTTP headers are required for that endpoint, for things like authentication?</p>
</li>
<li>
<p>Which properties are available in the request and response?</p>
</li>
<li>
<p>What are those various properties data types?</p>
</li>
<li>
<p>Which of those properties are required or optional?</p>
</li>
<li>
<p>What other validation rules can be applied to those properties?</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A contract is an agreement between two or more parties, especially one that is written and enforceable by law.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; The American Heritage Dictionary of the English Language
</div>
</div>
<div class="paragraph">
<p>Thinking about writing an API contract might sound a bit odd if you just think
about an API as sharing some data or as a convenient way to trigger commands on
another server, but people need to know what that data is, or what arguments
they should send to those commands.</p>
</div>
<div class="paragraph">
<p>The enforceable bit is important too. We can use those contracts in our test
suite to confirm that our actual APIs are following the rules of the contract.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Some people use the term "API Specifications" to describe all this, but
the word "specification" is used to mean a lot of different things. We just used
it in the last chapter for something totally different, so let&#8217;s stick to API
Contracts to avoid confusion.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Written down exactly from an early point (and agreed upon) means that there are
far fewer surprises throughout the API life-cycle, from planning, through
development, and into usage by clients.</p>
</div>
<div class="paragraph">
<p>Having a good contract means that API developers can be confident that:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The interface is doing what they intend</p>
</li>
<li>
<p>The interface is going to be useful for client developers</p>
</li>
<li>
<p>The interface is understood well by client developers</p>
</li>
<li>
<p>The interface is not changing accidentally when code changes</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This confidence will save everyone a lot of time, money and frustration. Having
no contract in place leads to slower rollout of the initial version, loads more
time spent testing subsequent deployments, and wasted developer time having
loads of meetings to explain things that could have been written down and clear
to everyone already.</p>
</div>
<div class="sect3">
<h4 id="_what_forms_can_an_api_contract_take">1.2.1. What forms can an API Contract take?</h4>
<div class="paragraph">
<p>Some folks might think "That sounds like documentation", others might think
"That sounds like tests". The answer is both, and more.</p>
</div>
<div class="paragraph">
<p>An API contract can exist in several forms, some more useful than others.</p>
</div>
<div class="sect4">
<h5 id="_the_dreaded_verbal_contract">The Dreaded Verbal Contract</h5>
<div class="paragraph">
<p>A common case is the verbal contract, where the API developers discuss it with
the frontend or other client application developers as they go. The backend
developers write their code, the client developers write theirs, and as various
endpoints or properties are conceived, they are explained somehow: literally
explained out loud over the conference room table, shouted over a hail of nerf
gun pellets and ping pong, or DMed over Slack chats.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Fred: Hey Sarah, there’s a new "fudge" field and it can be "blah" or "whatever".

Sarah: Great! Thanks I’ll chuck that in now.</pre>
</div>
</div>
<div class="paragraph">
<p>This might seem good enough as the API works, the app runs fine, the
project/product managers are happy, and the company may even be making money off
of this whole thing. Sadly this method has a bunch of downsides.</p>
</div>
<div class="paragraph">
<p>The primary issue is that communication is hard. You never really know if
somebody understood what you meant even if they say they did.</p>
</div>
<div class="paragraph">
<p>Beyond that, not having things written down means people can forget. If another
client team also needs the information and they ask another client team, they
are getting a copy of a copy which might be slightly wrong.</p>
</div>
<div class="paragraph">
<p>Another outcome is the original author(s) cannot remember the exact rules,
leading to time wasted checking the code. An even worse scenario is that the
original author(s) are not reachable for some reason. Maybe the whole team of
developers who worked on that API are all on a flight together from New York to
Uruguay, and for that entire 9 hour flight nobody can get any answers about how
the API is supposed to work, so they&#8217;re stuck not being able to fix a production
issue&#8230;&#8203; They might also have quit.</p>
</div>
<div class="paragraph">
<p>When folks rely on a verbal contract, two common things happen:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Developers waste time writing a new endpoint out of fear of using the old one</p>
</li>
<li>
<p>Developers waste time trying to guess the contract, and might guess wrong</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_shoddy_human_contracts">Shoddy Human Contracts</h5>
<div class="paragraph">
<p>When folks first start thinking about contracts, it often takes the form of
rudimentary API Reference Documentation. This might be dumped into a Google Doc,
shoved in a wiki, or written up in finger blistering HTML. These formats are
usually fairly painstaking to create, because you are focusing on formatting
<em>and</em> content, shuffling things around whenever you remember that you should
list headers too, and copying and pasting examples of JSON which might change
over time. API developers would not settle for writing software like this, but
apparently when it comes to documentation it&#8217;s accepted as the norm.</p>
</div>
<div class="paragraph">
<p>This whole slow, manual approach is probably why many people forgo writing
contracts this way, and opt for verbal contracts instead. It probably would not
be a huge jump to say the "startup mindset" (and "agile") are one of a few
potential driving factors in this "just get on with it" approach. There are many
technical leaders inexperienced in this area telling their team "We&#8217;ll write
lovely docs later when we&#8217;ve got more time!", without realizing their lack of
clarity is slowing down initial development, client integrations, increasing
testing efforts, and causing bizarre production issues and throughout their
ecosystem.</p>
</div>
<div class="paragraph">
<p>Anyway, aside from this medium of API contracts being time consuming, it is also
impossible to enforce. After you have spent the time writing up a Google
Doc/HTML/Wiki, the only output of that is going to be&#8230;&#8203; a Google Doc/HTML/Wiki
and maybe a PDF if you want to go wild. You can&#8217;t exactly jam that Google Doc
into an API test suite and have it confirm that the API is conforming to
whatever is written in there.</p>
</div>
<div class="paragraph">
<p>There is another way.</p>
</div>
</div>
<div class="sect4">
<h5 id="_description_languages">Description Languages</h5>
<div class="paragraph">
<p>A description language can be text based or look a bit like a programming
language. This format lets you describe an API in a reusable way, which means
you can do a whole bunch of stuff:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Documentation</p>
</li>
<li>
<p>Client-side validation</p>
</li>
<li>
<p>Server-side validation</p>
</li>
<li>
<p>Client-library Generation (SDKs)</p>
</li>
<li>
<p>UI Generation</p>
</li>
<li>
<p>Server/Application generation</p>
</li>
<li>
<p>Mock servers</p>
</li>
<li>
<p>Contract testing</p>
</li>
<li>
<p>Automated Postman/Paw Collections</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An early example of that would be SOAP, which used something called a WSDL,
something discussed in <a href="#theory-paradigms">the previous chapter</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The Web Services Description Language is an XML-based interface definition
language that is used for describing the functionality offered by a web service.
The acronym is also used for any specific WSDL description of a web service,
which provides a machine-readable description of how the service can be called,
what parameters it expects, and what data structures it returns. Therefore, its
purpose is roughly similar to that of a type signature in a programming
language.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Wikipedia
</div>
</div>
<div class="paragraph">
<p>WSDLs were only used for SOAP, and not many paradigms or implementations seemed
to bother with this sort of description language for a long time. Luckily that
has all changed over the last few years.</p>
</div>
<div class="paragraph">
<p>Before we look at how various description languages are used today, lets learn
another bit of theory.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_service_model_data_model">1.2.2. Service Model &amp; Data Model</h4>
<div class="paragraph">
<p>Two terms that pop up from time to time are "service model" and "data model".
These are two ways to specify which part of the API contract you are talking
about.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/data-model-service-model.png" alt="data model service model">
</div>
</div>
<div class="paragraph">
<p>The service model is the language used to describe things like the URL, HTTP
method, headers like content type, authentication strategy, etc. It is used to
explain all the things outside of the message, the stuff peripheral to the
actual data. In a programming language this would be class names, method names,
possible exceptions, but would not cover anything about the arguments: type
hints, possible validations, etc.</p>
</div>
<div class="paragraph">
<p>The data model is used to describe the contents of the message, which is
probably what you find in the HTTP body. The word "schema" is often associated
with the data model too. They are often just two different terms describing the
same concept, but often the term "schema" is used to represent the actual
technical file containing the description language, and the term data model is
more theoretical.</p>
</div>
<div class="paragraph">
<p>With this in mind, lets go look at how contracts are written for endpoint-based
APIs (REST, RESTish, some RPC), GraphQL and gRPC.</p>
</div>
</div>
<div class="sect3">
<h4 id="_introduction_to_api_description_languages">1.2.3. Introduction to API Description Languages</h4>
<div class="paragraph">
<p>Any generic HTTP API can use the same description languages, but the modern implementations which the conventions of HTTP to roll their own approach require their own specific description languages.</p>
</div>
<div class="paragraph">
<p>Here we use the term "HTTP APIs" to group REST, RESTish, and regular RPC when it&#8217;s just interacting over HTTP (GET, POST, etc) without some other set of conventions like gRPC getting involved.</p>
</div>
<div class="sect4">
<h5 id="_http_apis_openapi_json_schema">HTTP APIs: OpenAPI &amp; JSON Schema</h5>
<div class="paragraph">
<p>In the HTTP API world there were a few such as <a href="https://apiblueprint.org/">API
Blueprint</a>, <a href="https://raml.org/">RAML</a>, and OpenAPI (at the time called Swagger),
but for years the tooling was a bit lacking, and mostly only allowed for
outputting as documentation.</p>
</div>
<div class="paragraph">
<p>OpenAPI v3.0 popped in 2015 up which solved a lot of problems with OpenAPI v2.0, and beat the heck out of the other description formats. It took a few years for tooling to catch up, but by 2018 pretty much everything supported OpenAPI v3.0, and this description format settled as the mainstream favourite.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>The OpenAPI Specification (OAS) defines a standard, programming
language-agnostic interface description for REST APIs, which allows both humans
and computers to discover and understand the capabilities of a service without
requiring access to source code, additional documentation, or inspection of
network traffic.</pre>
</div>
</div>
<div class="listingblock">
<div class="title">An overly simplified example of OpenAPI describing an API which lists collections and resources of hats.</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">openapi: 3.0.2
info:
  title: Cat on the Hat API
  version: 1.0.0
  description: The API for selling hats with pictures of cats.
servers:
  - url: "https://hats.example.com"
    description: Production server
  - url: "https://hats-staging.example.com"
    description: Staging server

paths:
  /hats:
    get:
      description: Returns all hats from the system that the user has access to
      responses:
        '200':
          description: A list of hats.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/hats'

components:
  schemas:
    hats:
      type: array
      items:
        $ref: "#/components/schemas/hat"

    hat:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          enum:
            - bowler
            - top
            - fedora</code></pre>
</div>
</div>
<div class="paragraph">
<p>OpenAPI is a YAML or JSON based descriptive language which covers endpoints,
headers, requests and responses, allows for examples in different mime types,
outlines errors, and even lets developers write in potential values, validation
rules, etc.</p>
</div>
<div class="paragraph">
<p>Another popular language is <a href="http://json-schema.org/">JSON Schema</a>, which parts of OpenAPI
are based on. The two are mostly compatible, and are both used for slightly different but complimentary things.</p>
</div>
<div class="paragraph">
<p>OpenAPI can describe both service and data model, and JSON Schema mainly only
defines the data model. In the example above, everything under <code>paths</code> is
describing the service model, then everything under <code>components.schemas</code> is
describing the data model. The schema keywords that OpenAPI v3.0 uses are based
on JSON Schema, and there is a bit of a tangent we should look into here about
compatibility.</p>
</div>
<div id="WARNING" class="exampleblock">
<div class="content">
<div class="paragraph">
<p>OpenAPI v3.0 schema objects are a subset/superset/sideset implementation of
<em>JSON Schema draft 05</em>. Most JSON Schema keywords are available and work as
expected, a few extra OpenAPI-only keywords were added, but some JSON Schema
keywords are not supported. There is also the tricky situation where JSON Schema
has continued to progress quickly since draft 5 (draft 8 is almost complete at
time of writing).</p>
</div>
<div class="paragraph">
<p>This can cause confusion for new developers, but interoperability
amongst standards is always a tricky one. Thankfully, future versions of OpenAPI
(probably v3.1) aim to solve this, so no need to get too stuck in the weeds here.
For those who want to learn more,
<a href="https://blog.apisyouwonthate.com/openapi-and-json-schema-divergence-part-1-1daf6678d86e">this
first article</a> fully explains the situation, and
<a href="https://blog.apisyouwonthate.com/openapi-and-json-schema-divergence-part-2-52e282e06a05">this
second article</a> explains workarounds and longer term solutions.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>OpenAPI contract files are usually static. They&#8217;re usually written down along
with the source code, then sometimes deployed to a file hosting service like S3
for folks to use. Some managers want to treat these like business secrets and
hide them under lock and key, which makes absolutely no damned sense as they are
meta-data only. Most "hackers" could probably figure out that you keep your list
of companies under <code>GET /companies</code>, so just don&#8217;t make that a publicly
available endpoint and you&#8217;re gonna be ok. PayPal, Microsoft, and other
companies make their OpenAPI contracts available to anyone who wants to download
them, and this approach can help folks integrate with your APIs.</p>
</div>
<div class="paragraph">
<p>You can imagine an OpenAPI file growing to be rather unwieldy once its got 50+
endpoints and more complex examples, but have no fear you can spread things
around in multiple files to make it a lot more DRY (Don&#8217;t Repeat Yourself) and
useful. The first thing to go is usually the <code>components.schemas</code> definitions,
which can be moved to their own files. Once these are split into their own
files, an extra step can be taken to turn them into proper JSON Schema files.
Once they are split out they can be referenced in a HTTP response header.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Link: &lt;http://example.com/schemas/hat.json#&gt;; rel="describedby"</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a client sees this they can use it for all sorts of things - like form
generation and client-side validation - all without needing to figure out how to
distribute the files to them ahead of time.</p>
</div>
<div id="NOTE" class="exampleblock">
<div class="content">
<div class="paragraph">
<p>One more note on OpenAPI and its old name Swagger. You still see the word Swagger floating around a lot. SmartBear, the original authors of the "Swagger" API description language, still use the word Swagger in a lot of their tooling because they have the brand recognition. The description language itself was renamed to OpenAPI and handed over to the OpenAPI Initiative.</p>
</div>
<div class="paragraph">
<p>Since 2015, anyone calling it Swagger is out of date, and the fact that folks keep using the word Swagger in 2019 is still a huge source of confusion. If you look for "Swagger tools" you will only find those from SmartBear, or really really out of date ones. Call it OpenAPI, search for OpenAPI, and we don&#8217;t need to keep saying OpenAPI/Swagger like they yare two alternative but equally valid things.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>OpenAPI and JSON Schema are a fantastic pair, and we will show how to combine the two throughout the book.</p>
</div>
<div class="sect5">
<h6 id="_graphql_schemas">GraphQL Schemas</h6>
<div class="paragraph">
<p>GraphQL as an implementation comes bundled with
<a href="https://graphql.org/learn/schema/">GraphQL Schemas</a>. GraphQL does not really have
a service model, as it does not need one.</p>
</div>
<div class="paragraph">
<p>Seeing as most interactions operate under a
single HTTP endpoint like <code>POST /graphql</code>, there is no real need to
bother writing a contract around that in great detail. It would just be
mentioned in passing as an implementation detail, and the majority of the effort
would go into describing the data model.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Some folks might have different endpoints for different use-cases, but
this is rarely spotted in the wild.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All the GraphQL documentation examples are Star Wars. Sure, it&#8217;s obviously
inferior to Stargate SG-1, but let&#8217;s reuse their examples for simplicity:</p>
</div>
<div class="listingblock">
<div class="title">An example of GraphQL schemas in the GraphQL Schema Language, implementing interfaces and sharing properties across different types.</div>
<div class="content">
<pre class="highlight"><code class="language-graphql" data-lang="graphql">interface Character {
  id: ID!
  name: String!
  friends: [Character]
  appearsIn: [Episode]!
}

type Human implements Character {
  id: ID!
  name: String!
  friends: [Character]
  appearsIn: [Episode]!
  starships: [Starship]
  totalCredits: Int
}

type Droid implements Character {
  id: ID!
  name: String!
  friends: [Character]
  appearsIn: [Episode]!
  primaryFunction: String
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax in this example is using the
<a href="https://facebook.github.io/graphql/draft/#sec-Type-System">GraphQL Schema
Language</a> (a.k.a IDL), but these files can be written in whatever programming
language the API is built in: JavaScript, PHP, Go, whatever.</p>
</div>
<div class="paragraph">
<p>Writing them in Go for example would make them a little tricky to interact with
for other languages, like trying to give these types to a JavaScript web-app. If
the client really needs them, a lot of the language-specific implementations
offer a way to "Dump" them to the IDL, which can then be read by the client with
the right tooling.</p>
</div>
<div class="paragraph">
<p>If dumping and distributing isn&#8217;t a viable workflow,
<a href="https://graphql.org/learn/introspection/">introspection</a> can be used! This is
basically the process of quering the GraphQL API for information about the
schema, just like how <code>Link</code> is used to provide the client with the JSON Schema
in other HTTP APIs.</p>
</div>
<div class="paragraph">
<p>GraphQL schema does not support validation rules defined in the contract -
beyond required/optional/null like OpenAPI and JSON Schema, but there are some
extensions floating around which can help. More on all of that later.</p>
</div>
</div>
<div class="sect5">
<h6 id="_grpc_protobuf">gRPC: Protobuf</h6>
<div class="paragraph">
<p>gRPC uses another Google tool for its API contract:
<a href="https://developers.google.com/protocol-buffers/">Protobuf</a>. Protobuf is basically
a serializer for data going over the wire. Much like GraphQL and its schemas,
Protobuf is integral to gRPC. Instead of schemas they call them "Message Types",
but it&#8217;s all the same sort of idea.</p>
</div>
<div class="paragraph">
<p>Instead of writing them in whatever language the API is written in (like
GraphQL), a new  <code>.proto</code> file is written using
<a href="https://developers.google.com/protocol-buffers/docs/proto">Protocol Buffer
Language Syntax</a>. This C-family/Java style language exists solely for writing
these files. It might be a bit of a pain to figure out a brand new syntax, but
it has the benefit of being fairly portable as you can read them in multiple
languages. Finding a JavaScript, Ruby, Python, Go, etc. tool that can read a
<code>.proto</code> file is a whole lot easier than trying to get Python to read something
written in  - for example - JavaScript.</p>
</div>
<div class="paragraph">
<p>Rarely are <code>.proto</code> files made available over a URL, they are usually bundled
and distributed with client code. Then usually things are kept backwards
compatible until the clients have upgraded whatever client code brought the
<code>.proto</code> files their way.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_when_are_contracts_written_and_by_who">1.2.4. When Are Contracts Written, And By Who?</h4>
<div class="paragraph">
<p>At what stage these contracts are written, and by who, is very much up to the
culture of the organization. In some organizations the culture is "We dont
bother at all" and I&#8217;ve been there. I spent two years helping teams fix the
issues that came up from being vague about this stuff, and witnessed a lot of my
friends and colleagues waste time (and the companies time) guessing contracts.</p>
</div>
<div class="paragraph">
<p>When I first got to that company, the culture relating to API contracts was:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>That&#8217;s the thing that Phil keeps going on about, I think? Just ignore him. We&#8217;ve got unstable, untested, undocumented APIs full of problems to try and sort out, and they&#8217;re being misused by clients. No time for any of that contract-first planning, or contract-later nonsense.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Two years later and that culture had changed substantially, to the point where
most older APIs had contracts written down, and new ones invariably had
contracts written before the work was started. Don&#8217;t make me come to your office
and shout at you for two years, just start planning your APIs properly now.</p>
</div>
<div class="paragraph">
<p>Who should create and maintain contracts? Everyone.</p>
</div>
<div class="paragraph">
<p>When they should be created? As early as possible.</p>
</div>
<div class="paragraph">
<p>If one person is tasked with developing an API, then that is the one person who
should be writing the contracts as a planning stage, before they start working
on the actual API code.</p>
</div>
<div class="paragraph">
<p>If a whole team is tasked with developing an API, then that team should split up
the planning work between them.</p>
</div>
<div class="paragraph">
<p>The planning process involved getting out a whiteboard, getting a few of your
clients in a room so you can listen to their needs (instead of just dictating
to them), get somebody who knows a bit more about systems architecture than the
average developer does (everyone thinks they&#8217;re an expert), and hash out some
ideas.</p>
</div>
<div class="paragraph">
<p>When those ideas start to solidify, start writing things down, and turn those
notes into API contracts. When they&#8217;re ready, get them into a GitHub pull
request, or some other collaborative place, and folks on your team can start to
review them.</p>
</div>
<div class="paragraph">
<p>Sometimes you would even see full service and data models written up and
attached to the JIRA tasks!<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>.</p>
</div>
<div class="sect4">
<h5 id="_contract_first_vs_contract_later">Contract-First vs Contract-Later</h5>
<div class="paragraph">
<p>Whenever the topic of contract-first API development comes up, somebody will say "Damn, that sounds pretty good, but we already have an API written, and we didn&#8217;t write down the contract!"</p>
</div>
<div class="paragraph">
<p>Fear not. Some more strict languages like Go and Java have annotation-based
systems which can allow you to sprinkle some syntax around your applications to
generate some API contracts. This approach does not work so well for dynamic
programming languages like Ruby because anything can be anything and you end up
having to write so much in manually that you might as well just be writing
proper API contracts.</p>
</div>
<div class="paragraph">
<p>There are a few tools out there which will help you create contracts by
reading your JSON requests and responses.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_summary">1.2.5. Summary</h4>
<div class="paragraph">
<p>The terms "API Contract" and "API Specifications" often mean the same thing
depending on the context, but the term specification is used to describe a lot
of other things in this space too. If you are talking about planning, building,
or documenting an API and somebody mentions "API specifications", then they are
talking about this stuff.</p>
</div>
<div class="paragraph">
<p>The terms "schema", and "data model", are usually closely related. In the terms
of an HTTP API, the data model describes the body of the HTTP message, and the
technical document or actual file which provides that description is often
referred to as a schema.</p>
</div>
<div class="paragraph">
<p>Ask a bunch of different people and you will get a lot of difference answers,
but these terms will be used throughout the book just so there is one standard
way of talking.</p>
</div>
<div class="paragraph">
<p>Writing down contracts might seem like a lot of work, but these days it should
no longer be considered as an optional step. Flinging around arbitrary JSON and
hoping people and other applications are all using it properly over time is just
reckless, selfish, and actually makes work considerably more mundane. Seeing as
API contracts are not just for creating documentation, writing the contract down
with a decent description language increases productivity throughout the
life-cycle of the API. Then reference documentation appears for free as one of
many outputs of the description language using documentation generators.</p>
</div>
<div class="paragraph">
<p>Later chapters will cover exactly how contracts can get involved at various
points, like how we can use the contracts to get feedback, and specific tools we
can use to collaborate on this stuff.</p>
</div>
<div class="paragraph">
<p>This introduction will most likely have left you with questions, and they will
be answered throughout the rest of the book.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_part_two_planning_design">2. Part Two: Planning &amp; Design</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_2">2.1. Introduction</h3>
<div class="paragraph">
<p>When I was younger and dumber, the planning stage for APIs was pretty much
"think of a list of endpoints then start coding". This is wildly insufficient.
As the <a href="#theory-contracts">API Contracts</a> chapter explained, contracts are
incredibly important throughout the life-cycle of an API.</p>
</div>
<div class="paragraph">
<p>The information provided in <em>Part One: Theory</em> is going to come in useful for
this section, as we go through the actual planning of an API. During this
process we will plan an API properly, instead of doing the cowboy nonsense I
used to get up to.</p>
</div>
<div class="paragraph">
<p>The planning and design phase of an API is intended to do two things:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make developers think really hard about the requirements for their API</p>
</li>
<li>
<p>Gather feedback from client application developers</p>
</li>
<li>
<p>Use the feedback to improve the planning before the development phase begins</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_time_is_money">2.1.1. Time is Money</h4>
<div class="paragraph">
<p>Poorly planned APIs waste a lot of time. Developers cost money, so paying extra
money for developers to rewriting a bunch of code they wrote just recently due
to some oversight is a cost most companies would like to avoid. I&#8217;ve seen APIs
go from v1 to v2 in the first few months, because the developers handed over a
finished product which might have been ok for one client, but caused some issues
for another client.</p>
</div>
<div class="paragraph">
<p>If that client had been involved earlier on then a solution could have been
found to satisfy the needs of both clients, and the v1 could have been used for
both. Now we&#8217;ve got two separate versions of the API being used at the same
time, with developers maintaining two code paths, and at some point the original
client using the original version of the API is going to have to rewrite their
code to use the newer version of the API. What a daft mess.</p>
</div>
</div>
<div class="sect3">
<h4 id="_gather_feedback_early">2.1.2. Gather Feedback Early</h4>
<div class="paragraph">
<p>If clients had more insight into the planning of the API, they have a much
better chance of catching out issues earlier on. We can give them fake API
implementations to work with (these are called "Mocks" or "Mock Servers"), and
when these are based on API contracts the mocks are generated with minimal
effort from API developers.</p>
</div>
<div class="paragraph">
<p>Making a few tweaks to the API contract files is much easier than rewriting a
prototype and all of the tests that go with it, and is infinitely easier than
deprecating and removing code that has already made it to production.</p>
</div>
<div class="paragraph">
<p>This is much closer to the Agile workflow, instead of the Waterfall model.
Waterfall is junk for API development.</p>
</div>
<div class="paragraph">
<p>So, you are sold that API contracts are the way to go, you&#8217;ve picked your
paradigm (and possibly an implementation too), and now you want to start writing
down what the actual API is going to look like.</p>
</div>
<div class="paragraph">
<p>You might not want to start typing special YAML/JSON/Protobuf blindly into an
empty text file. This has been used as an argument against API contracts for a
very long time, but it has never been true. We can use text-based or visual
editors, which have special knowledge of these description formats, to speed up
the development of our contracts!</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_editors">2.2. Editors</h3>
<div class="paragraph">
<p>Editors exist in various forms for various API description languages, and they
can drastically ease the creation of contracts when starting from scratch. These
can take a few forms.</p>
</div>
<div class="sect3">
<h4 id="_text_or_gui">2.2.1. Text or GUI</h4>
<div class="paragraph">
<p>Some editors are GUI-based (Graphical User Interface) and let you design things
with clicking buttons and working with forms.</p>
</div>
<div class="paragraph">
<p>Others are text-based and provide you with a real-time preview panel whilst you
type, making it slightly easier than working with plain-old YAML/JSON.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prototyping_walled_gardens_local_file_editors">2.2.2. Prototyping, Walled Gardens, &amp; Local File Editors</h4>
<div class="paragraph">
<p>Beyond the "text-based" or "GUI" distinction, there are other characteristics
which will effect where the contracts live and how you interact with them.</p>
</div>
<div class="paragraph">
<p>Some editors are intended for rapid prototyping only, helping you to create an
initial design and then push you to export the contracts as text to
copy-and-paste, or download as files. From that point on, you&#8217;re on your own,
and have to find some other way to keep your contract files up-to-date.</p>
</div>
<div class="paragraph">
<p>Others are hosted solutions which keep a hold of your contract files, and offer
limited options for syncing to whatever pre-determined locations they chose to
support. Maybe something specific like GitLab, or generic git repository, or
they publish them to a URL accessible over HTTP, or something else.</p>
</div>
<div class="paragraph">
<p>Other editors can take the form of desktop applications, which can be used
throughout the life-cycle, loading local files and allowing you to edit them at
commit them back to the repository (or wherever they live) at will.</p>
</div>
</div>
<div class="sect3">
<h4 id="_openapi_editors">2.2.3. OpenAPI Editors</h4>
<div class="sect4">
<h5 id="_swagger_editor">Swagger Editor</h5>
<div class="paragraph">
<p>Swagger Editor is a very simple hosted text-based editor from
<a href="https://smartbear.com/">SmartBear</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Remember, SmartBear call their suite of tools "Swagger" because they own
the copyright and they don&#8217;t feel like re-branding, but the description language
is officially called OpenAPI, not Swagger. Nobody else should be using the word
Swagger, or calling their tooling Swagger, or anything else.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/editors-swagger-editor.png" alt="editors swagger editor">
</div>
</div>
<div class="paragraph">
<p>Mostly it is just a text-editor, with the left panel being a YAML/JSON editor,
and the right panel is <a href="https://swagger.io/tools/swagger-ui/">Swagger UI</a>, the
documentation tool from SmartBear.</p>
</div>
<div class="paragraph">
<p>It can be nice to write specifications on the left and see their rendering as
documentation on the right, but it would possibly be more useful if the right
contained forms for managing the specification beyond modifying text, but the
right panel is purely read-only. There are a few forms for adding new
operations, tags, servers, etc. but they do not cover everything.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/editors-swagger-editor-form.png" alt="editors swagger editor form">
</div>
</div>
<div class="paragraph">
<p>This simple editor helps in a few cases, like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You have never written any OpenAPI and want to try playing around with real-time feedback</p>
</li>
<li>
<p>You are getting validation errors from some local tool which seem weird, so you bundle the multiple files into one file and paste it up here to see what it says</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is not much else you will want to use Swagger Editor for. If you are
splitting files up using <code>$ref</code> (which you pretty much always want to do), then
this will not work as it only supports the one text box.</p>
</div>
<div class="paragraph">
<p>For ongoing editing and multi-file support you will need something a bit more powerful.</p>
</div>
</div>
<div class="sect4">
<h5 id="_swaggerhub">SwaggerHub</h5>
<div class="paragraph">
<p><a href="https://swagger.io/tools/swaggerhub/">SwaggerHub</a> is another tool from Smartbear, and it is basically the hosted version of Swagger Editor which has some integrations with the rest of the Swagger tool-suite.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/editors-swaggerhub-demo.png" alt="editors swaggerhub demo">
</div>
<div class="title">Figure 4. In this demo of SwaggerHub you can see Swagger Editor in full swing, with a few other options floating around the outside.</div>
</div>
<div class="paragraph">
<p>SwaggerHub includes a mock server, as most of these editors do. It will help you
converting from OpenAPI v2.0 to v3.0 which is a nice touch. The integration with
Swagger Inspector - a lovely tool which can help build OpenAPI specifications
off of HTTP interactions&#8230;&#8203; more on that later.</p>
</div>
<div class="paragraph">
<p>The collaboration options here are pretty handy. You can invite users or teams
to collaborate on an API, and they have a permissions system which seems pretty
closely modelled on Google Docs.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/editors-swaggerhub-invite.png" alt="editors swaggerhub invite">
</div>
<div class="title">Figure 5. Get collaborating with other folks without having to email YAML files around!</div>
</div>
<div class="paragraph">
<p>If working with multiple files is possible in SwaggerHub, I have certainly never
figured it out. For this reason I have steered clear, but for teams just
starting out it might be worth playing with.</p>
</div>
<div class="paragraph">
<p>The pricing is user-based, and does not seem to support "monthly active users"
like slack. Many companies only have 1 or 2 folks who care about API contracts
(which is sad and slowly improving over time) but at a company with ~100
engineers (and a better culture), this could get rather expensive. Trying to
convince your boss that a YAML text-editor with collaboration might be a tough
sell, especially when there are more powerful alternatives, or free open-source
offerings.</p>
</div>
</div>
<div class="sect4">
<h5 id="_stoplight">Stoplight</h5>
<div class="paragraph">
<p><a href="http://stoplight.io/">Stoplight</a> is a GUI editor, with forms and a much more
"Wizard"-like approach. You can ignore the YAML representation entirely and work
with their forms and model editors.</p>
</div>
<div class="paragraph">
<p>Right now they only support OpenAPI v2.0 via the GUI but the text mode supports
OpenAPI v3.0. They have all sorts of amazing features. Stoplight has the usual
collaboration and mocking, and other features like linting based on style
guides, the ability to share models throughout the organization (to avoid having
20 different "user" or "location" representations) and has desktop applications
for Windows, Mac and Linux.</p>
</div>
<div class="paragraph">
<p>I started working for Stoplight right around the time I started writing this
second book, so to avoid complex bias I will share some words from Kin "API
Evangelist" Lane:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>I feel like Stoplight has the potential to shift the landscape pretty significantly, something I haven&#8217;t seen any API service provider do in a while.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Kin Lane<br>
<cite>API Evangelist</cite>
</div>
</div>
<div class="paragraph">
<p>More to come on this one. They will most likely have a new suite of tools out
before this book goes to the printer.</p>
</div>
<div class="paragraph">
<p>Stoplight costs more than SwaggerHub, but is likely to be an easier sell due to
the fact it does a whole lot more. Non-technical users can get in there to play
around, and it adds a lot more value beyond being a YAML/JSON text-editor.</p>
</div>
</div>
<div class="sect4">
<h5 id="_freeopen_source_tools">Free/Open-Source Tools</h5>
<div class="paragraph">
<p>Bootstrapping a project and have no budget for fancy tooling? Not a problem.</p>
</div>
<div class="paragraph">
<p>Check out <a href="https://openapi.tools">OpenAPI.tools</a> for an up-to-date list, but there
are a few GUI editors, and a few plugins for popular software like
<a href="https://code.visualstudio.com/">Visual Studio Code</a>, <a href="https://atom.io/">Atom</a>, etc.
which can ease the struggle of writing the files by hand.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>VS Code: <a href="https://marketplace.visualstudio.com/items?itemName=mermade.openapi-lint">openapi-lint</a></p>
</li>
<li>
<p>Atom: <a href="https://atom.io/packages/linter-swagger">linter-swagger</a></p>
</li>
<li>
<p>Jetbrains IDE: <a href="https://senya.io/">Senya</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then there is <a href="https://apibldr.com/">ApiBldr</a>, a free hosted GUI editor which can
help build and then download contracts.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_graphql_editors">2.2.4. GraphQL Editors</h4>
<div class="paragraph">
<p><a href="https://graphqleditor.com/">GraphQL Editor</a> is a GUI editor, with text on the
left where you define various types, and a visual representation of everything
as nodes on the right. You can click on those nodes, modify properties, and set
criteria like required, null, etc.</p>
</div>
<div class="paragraph">
<p>It can be installed locally via npm, then invoked as a React component.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t know what any of those things mean then fair enough, there is a
hosted version: <a href="https://app.graphqleditor.com/">GraphQL Editor Cloud</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/editors-graphql-editor.png" alt="editors graphql editor">
</div>
<div class="title">Figure 6. A screenshot of <a href="https://app.graphqleditor.com/showcase/github">the "Github example" on graphqleditor.com</a></div>
</div>
<div class="paragraph">
<p>As with many editors it comes with an option to provide a mock server for the
schemas you&#8217;ve just written up. The hosted version also has the ability to save
projects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_protobuf_editors">2.2.5. Protobuf Editors</h4>
<div class="paragraph">
<p>The Protobuf syntax is incredibly simple, and there is not much going on in the
way of functionality or logic in these files. Maybe this is why there are not
many GUI editors around, as you just don&#8217;t need them.
<a href="https://sourceforge.net/projects/protobufeditor/">Protobuf Editor</a> is one I found
lurking on SourceForge.</p>
</div>
<div class="paragraph">
<p>There are plenty of plugins ready to add syntax highlighting, linting,
auto-complete, etc. to your IDE or code editor of choice.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>VS Code: <a href="https://marketplace.visualstudio.com/items?itemName=zxh404.vscode-proto3">vscode-proto3</a></p>
</li>
<li>
<p>Atom: <a href="https://atom.io/packages/language-protobuf">language-protobuf</a></p>
</li>
<li>
<p>Jetbrains IDE: <a href="https://plugins.jetbrains.com/plugin/8277-protobuf-support">Protbuf Support</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_maybe_you_dont_use_an_editor">2.2.6. Maybe You Don&#8217;t Use an Editor</h4>
<div class="paragraph">
<p>This can be a personal choice. Some folks love having their contracts live up in
the cloud so they can be easily collaborated on, some want to keep them in the
repository so they can discuss things in GitHub pull-requests for their
collaboration, and as such want editors which can work with local files.</p>
</div>
<div class="paragraph">
<p>Whatever you do, when you start out I recommend using an editor to get the ball
rolling. Then later on if you want to tweak things by hand, that&#8217;s probably ok.
It will be a while before you work out your exact workflow for contracts (if
nobody has worked that out for you), so it can make sense to just get stuck in
with whatever hosted editor, then you can probably export things later and
cancel your account if you hate it.</p>
</div>
<div class="paragraph">
<p>Either way, if you are currently working on an API now, put this book down for a
little bit, and get to work on creating some API contracts. It could be
nonsense, or it could be a real project, but the next chapter will start by
assuming you have written up a bunch of API contracts, and want to put them to
work in a mock server to get feedback from potential clients.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_part_three_testing_monitoring">3. Part Three: Testing &amp; Monitoring</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_part_four_management">4. Part Four: Management</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_part_five_further_theory">5. Part Five: Further Theory</h2>
<div class="sectionbody">

</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. JIRA is a 'popular' piece of project management software from Atlassian
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-03-04 11:10:47 WET
</div>
</div>
</body>
</html>